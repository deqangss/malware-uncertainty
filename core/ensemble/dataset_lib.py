""" This script is for building dataset """

import tensorflow as tf


def build_dataset_from_numerical_data(data):
    """
    serialize the data to accommodate the format of model input
    :param data, tuple or np.ndarray
    """
    return tf.data.Dataset.from_tensor_slices(data)


def build_dataset_via_generator(generator):
    return tf.data.Dataset.from_generator(lambda: generator,
                                          output_types=(tf.int32, tf.int32),
                                          output_shapes=(tf.TensorShape([None]), tf.TensorShape([]))
                                          )


def build_dataset_from_img_generator(generator):
    return tf.data.Dataset.from_generator(lambda: generator,
                                          output_types=(tf.float32, tf.float32),
                                          output_shapes=(tf.TensorShape([None]), tf.TensorShape([]))
                                          )
